(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4212:(t,e,a)=>{"use strict";a.d(e,{default:()=>m});var s=a(5155),i=a(2115),n=a(8274),l=a(760);let r=()=>{let[t,e]=(0,i.useState)(new Date),[a,l]=(0,i.useState)(!1),[r,o]=(0,i.useState)(0),[c,d]=(0,i.useState)(0),[h,x]=(0,i.useState)(0);if((0,i.useEffect)(()=>{l(!0);let t=new Date,a=t.getSeconds(),s=t.getMinutes(),i=t.getHours()%12,n=setInterval(()=>{let t=new Date,n=t.getSeconds(),l=t.getMinutes(),r=t.getHours()%12;59===a&&0===n&&o(t=>t+360),59===s&&0===l&&d(t=>t+360),11===i&&0===r&&x(t=>t+360),e(t),a=n,s=l,i=r},1e3);return()=>clearInterval(n)},[]),!a)return(0,s.jsx)("div",{className:"w-round h-round rounded-round bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center overflow-hidden relative",children:(0,s.jsx)("div",{className:"text-white/20",children:"Loading..."})});let u=t.getHours(),f=t.getMinutes(),m=t.getSeconds();t.getDate(),t.toLocaleDateString("en-US",{month:"short"}),t.getFullYear(),t.toLocaleDateString("en-US",{weekday:"long"});let g=6*m-90+r,p=6*f+.1*m-90+c,b=u%12*30+.5*f-90+h,w=Array.from({length:60},(t,e)=>({angle:6*e,isFiveMinute:e%5==0}));return(0,s.jsxs)("div",{className:"w-round h-round rounded-round bg-black flex items-center justify-center overflow-hidden relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 rounded-full",children:w.map(t=>{let{angle:e,isFiveMinute:a}=t;return(0,s.jsx)("div",{className:"absolute bg-white origin-bottom ".concat(a?"w-0.5 h-6":"w-px h-3"),style:{top:a?"16px":"19px",left:"50%",transform:"translateX(-50%) rotate(".concat(e,"deg)"),transformOrigin:"50% ".concat(a?"224px":"221px")}},e)})}),(0,s.jsxs)("div",{className:"absolute inset-0 rounded-full",children:[(0,s.jsx)(n.P.div,{className:"absolute w-1.5 bg-white origin-bottom",style:{height:"120px",top:"120px",left:"50%",transform:"translateX(-50%) rotate(".concat(b,"deg)"),transformOrigin:"50% 120px"},animate:{rotate:b+90},transition:{type:"spring",damping:50,stiffness:100}}),(0,s.jsx)(n.P.div,{className:"absolute w-1 bg-white origin-bottom",style:{height:"160px",top:"80px",left:"50%",transform:"translateX(-50%) rotate(".concat(p,"deg)"),transformOrigin:"50% 160px"},animate:{rotate:p+90},transition:{type:"spring",damping:50,stiffness:100}}),(0,s.jsx)(n.P.div,{className:"absolute w-px bg-white origin-bottom",style:{height:"180px",top:"60px",left:"50%",transform:"translateX(-50%) rotate(".concat(g,"deg)"),transformOrigin:"50% 180px"},animate:{rotate:g+90},transition:{type:"spring",damping:30,stiffness:200}})]}),(0,s.jsx)("div",{className:"absolute w-2 h-2 bg-white rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10"})]})};var o=a(4416),c=a(7298),d=a(4516);function h(t,e,a,s,i){let n=function(t,e,a,s){let i=t*Math.PI/180,n=a*Math.PI/180,l=(s-e)*Math.PI/180;return(180*Math.atan2(Math.sin(l)*Math.cos(n),Math.cos(i)*Math.sin(n)-Math.sin(i)*Math.cos(n)*Math.cos(l))/Math.PI+360)%360}(t,e,a,s)-(({N:0,NE:45,E:90,SE:135,S:180,SW:225,W:270,NW:315})[i.toUpperCase()]||0);return n<0&&(n+=360),n}let x=t=>{let{isVisible:e,flightCount:a,newFlights:l,newFlightsWithInfo:r,allFlights:x,userLocation:u,onDismiss:f}=t,[m,g]=(0,i.useState)([]);return((0,i.useEffect)(()=>{r&&r.length>0&&g(t=>{let e=t.map(t=>t.hexCode);return[...t,...r.filter(t=>!e.includes(t.hexCode))]})},[r]),(0,i.useEffect)(()=>{e||g([])},[e]),e)?(u&&r&&r.length>0&&h(u.latitude,u.longitude,r[0].flight.lat||0,r[0].flight.lon||0,u.facingDirection),(0,s.jsxs)(n.P.div,{className:"w-round h-round rounded-round bg-gradient-to-br from-blue-900 via-blue-800 to-blue-900 flex flex-col items-center justify-center overflow-hidden relative shadow-2xl",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},transition:{type:"spring",damping:20,stiffness:200},children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,s.jsx)(n.P.div,{className:"absolute inset-0",animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},children:Array.from({length:8}).map((t,e)=>(0,s.jsx)("div",{className:"absolute w-1 h-full bg-white",style:{left:"50%",transformOrigin:"50% 50%",transform:"translateX(-50%) rotate(".concat(45*e,"deg)")}},e))})}),(0,s.jsx)("button",{onClick:f,className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center hover:bg-white/20 transition-colors",children:(0,s.jsx)(o.A,{className:"w-4 h-4 text-white/70"})}),(0,s.jsxs)(n.P.div,{className:"text-center z-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,s.jsx)(n.P.div,{className:"mb-6",animate:{y:[0,-10,0],rotate:[0,5,0,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(c.A,{className:"w-16 h-16 text-white mx-auto"})}),u&&x&&x.slice(0,8).map((t,e)=>{if(!t.lat||!t.lon)return null;let a=h(u.latitude,u.longitude,t.lat,t.lon,u.facingDirection),i=Math.PI/180*(a-90),r=180*Math.cos(i),o=180*Math.sin(i),c=l.includes(t.hex);return(0,s.jsxs)(n.P.div,{className:"absolute z-20",style:{left:"calc(50% + ".concat(r,"px)"),top:"calc(50% + ".concat(o,"px)"),transform:"translate(-50%, -50%)"},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,left:"calc(50% + ".concat(r,"px)"),top:"calc(50% + ".concat(o,"px)")},transition:{delay:c?.5+.1*e:0,duration:.8,ease:"easeOut"},children:[(0,s.jsx)("div",{className:"w-0 h-0 border-l-[8px] border-r-[8px] border-b-[12px] border-l-transparent border-r-transparent ".concat(c?"border-b-yellow-400":"border-b-blue-400"),style:{transform:"rotate(".concat(a+180,"deg)"),filter:"drop-shadow(0 0 4px rgba(".concat(c?"255, 255, 0":"59, 130, 246",", 0.6))")}}),t.flight&&(0,s.jsx)("div",{className:"absolute text-xs font-semibold whitespace-nowrap ".concat(c?"text-yellow-300":"text-blue-300"),style:{left:"50%",top:"100%",transform:"translate(-50%, 4px)",textShadow:"0 0 4px rgba(0, 0, 0, 0.8)"},children:t.flight})]},t.hex)}),(0,s.jsx)(n.P.h1,{className:"text-3xl font-light text-white mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:"New Flight!"}),m&&m.length>0?(0,s.jsxs)(n.P.div,{className:"space-y-3 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:[m.slice(0,2).map((t,e)=>{var a,i,l,r;let o=u?function(t,e,a,s,i){let n=h(t,e,a,s,i);return n>=337.5||n<22.5?"straight ahead":n>=22.5&&n<67.5?"ahead and to the right":n>=67.5&&n<112.5?"to your right":n>=112.5&&n<157.5?"behind and to the right":n>=157.5&&n<202.5?"behind you":n>=202.5&&n<247.5?"behind and to the left":n>=247.5&&n<292.5?"to your left":n>=292.5&&n<337.5?"ahead and to the left":"nearby"}(u.latitude,u.longitude,t.flight.lat||0,t.flight.lon||0,u.facingDirection):"nearby";return(0,s.jsxs)(n.P.div,{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3 text-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8+.1*e},children:[t.flight.flight&&(0,s.jsx)("div",{className:"text-white font-semibold text-lg mb-1",children:t.flight.flight}),(0,s.jsxs)("div",{className:"text-white/60 text-xs mb-2 italic",children:["Look ",o]}),t.info?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-white/80 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.A,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:(null==(a=t.info.origin)?void 0:a.airport)||(null==(i=t.info.origin)?void 0:i.iata)||"Unknown"})]}),(0,s.jsx)("span",{children:"â†’"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.A,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:(null==(l=t.info.destination)?void 0:l.airport)||(null==(r=t.info.destination)?void 0:r.iata)||"Unknown"})]})]}),t.info.route&&(0,s.jsx)("div",{className:"text-white/60 text-xs",children:t.info.route})]}):(0,s.jsxs)("div",{className:"text-white/60 text-sm",children:["Aircraft: ",t.flight.type||"Unknown"]})]},t.hexCode)}),m.length>2&&(0,s.jsxs)(n.P.div,{className:"text-white/60 text-sm",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},children:["+",m.length-2," more"]})]}):(0,s.jsx)(n.P.p,{className:"text-white/70 text-lg mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:1===l.length?"Aircraft entered your area":"".concat(l.length," aircraft entered your area")}),(0,s.jsxs)(n.P.div,{className:"bg-white/10 backdrop-blur-sm rounded-full px-6 py-2 text-white/90",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.9},children:[a," flight",1!==a?"s":""," in area"]})]}),(0,s.jsx)(n.P.div,{className:"absolute inset-8 rounded-full border-2 border-white/20",animate:{scale:[1,1.1,1],opacity:[.2,.5,.2]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]})):null},u=t=>{let{sharedFlightData:e,isAlertActive:a,setIsAlertActive:n}=t,{flights:o,newFlights:c,newFlightsWithInfo:d,totalFlights:h,lastUpdate:u,userLocation:f,isLoading:m,error:g,hasNewFlight:p,clearNewFlightAlert:b,refetch:w}=e;i.useEffect(()=>{if(p){n(!0);let t=setTimeout(()=>{b(),n(!1)},3e4);return()=>clearTimeout(t)}n(!1)},[p,b]);let v=i.useCallback(()=>{b(),n(!1)},[b]);return i.useEffect(()=>{o.length>0&&console.log("".concat(o.length," flights in area:"),o.map(t=>({hex:t.hex,flight:t.flight||"Unknown",alt:t.alt_baro||"N/A"})))},[o]),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.N,{mode:"wait",children:p?(0,s.jsx)(x,{isVisible:p,flightCount:h,newFlights:c,newFlightsWithInfo:d,allFlights:o,userLocation:f,onDismiss:v},"alert"):(0,s.jsx)(r,{},"clock")}),!1]})},f=t=>{let{flightData:e}=t,{flights:a,userLocation:i,isLoading:l,error:r}=e;return r?(0,s.jsx)("div",{className:"w-screen h-screen bg-black flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-red-400 text-center",children:[(0,s.jsx)("div",{className:"text-xl mb-2",children:"Error"}),(0,s.jsx)("div",{className:"text-sm",children:r})]})}):(0,s.jsx)("div",{className:"w-screen h-screen bg-black flex items-center justify-center overflow-hidden relative",children:(0,s.jsxs)("div",{className:"w-round h-round rounded-round border-2 border-white/20 relative",children:[[.25,.5,.75].map(t=>{let e=180*t,a=t*parseInt("6");return(0,s.jsx)("div",{className:"absolute rounded-full border border-white/10",style:{width:"".concat(2*e,"px"),height:"".concat(2*e,"px"),left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,s.jsxs)("div",{className:"absolute text-xs text-white/40 font-mono",style:{right:"-20px",top:"50%",transform:"translateY(-50%)"},children:[a.toFixed(1),"nm"]})},t)}),(0,s.jsx)("div",{className:"absolute w-2 h-2 bg-white rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10"}),i&&a&&a.map((t,e)=>{if(!t.lat||!t.lon)return null;let a=h(i.latitude,i.longitude,t.lat,t.lon,i.facingDirection),l=function(t,e,a,s){let i=t*Math.PI/180,n=a*Math.PI/180,l=(a-t)*Math.PI/180,r=(s-e)*Math.PI/180,o=Math.sin(l/2)*Math.sin(l/2)+Math.cos(i)*Math.cos(n)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*3440.065}(i.latitude,i.longitude,t.lat,t.lon),r=180*Math.min(l/parseInt("6"),1),o=Math.PI/180*(a-90),c=Math.cos(o)*r,d=Math.sin(o)*r;return(0,s.jsxs)(n.P.div,{className:"absolute z-20",style:{left:"calc(50% + ".concat(c,"px)"),top:"calc(50% + ".concat(d,"px)"),transform:"translate(-50%, -50%)"},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,left:"calc(50% + ".concat(c,"px)"),top:"calc(50% + ".concat(d,"px)")},transition:{duration:.8,ease:"easeOut"},children:[(0,s.jsx)("div",{className:"w-0 h-0 border-l-[8px] border-r-[8px] border-b-[12px] border-l-transparent border-r-transparent border-b-white",style:{transform:"rotate(".concat(a+180,"deg)"),filter:"drop-shadow(0 0 4px rgba(255, 255, 255, 0.6))"}}),t.flight&&(0,s.jsxs)("div",{className:"absolute text-xs text-white font-semibold whitespace-nowrap text-center",style:{left:"50%",top:"100%",transform:"translate(-50%, 4px)",textShadow:"0 0 4px rgba(0, 0, 0, 0.8)"},children:[(0,s.jsx)("div",{children:t.flight}),(0,s.jsxs)("div",{className:"text-white/60 text-xs font-mono",children:[l.toFixed(1),"nm"]})]})]},t.hex)}),l&&(0,s.jsx)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)("div",{className:"text-white/60 text-sm",children:"Updating..."})}),(0,s.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2",children:(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 text-white/90 text-sm",children:[a.length," aircraft tracked"]})})]})})},m=()=>{let[t,e]=(0,i.useState)(0),[a,l]=(0,i.useState)(!1),[r,o]=(0,i.useState)(!1),c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,[e,a]=(0,i.useState)({flights:[],newFlights:[],total:0,timestamp:0,lastUpdate:0}),[s,n]=(0,i.useState)(!1),[l,r]=(0,i.useState)(null),[o,c]=(0,i.useState)(!1),d=(0,i.useCallback)(async()=>{n(!0),r(null);try{let t=await fetch("/api/flights"),e=await t.json();e.error?r(e.error):(a(e),e.newFlights&&e.newFlights.length>0&&(c(!0),console.log("New flights detected:",e.newFlights)))}catch(t){r(t instanceof Error?t.message:"Failed to fetch flights")}finally{n(!1)}},[]),h=(0,i.useCallback)(()=>{c(!1)},[]);return(0,i.useEffect)(()=>{d();let e=setInterval(d,t);return()=>clearInterval(e)},[d,t]),{flights:e.flights,newFlights:e.newFlights,newFlightsWithInfo:e.newFlightsWithInfo||[],totalFlights:e.total,lastUpdate:e.lastUpdate,userLocation:e.userLocation,isLoading:s,error:l,hasNewFlight:o,clearNewFlightAlert:h,refetch:d}}((0,i.useCallback)(()=>0===t?r?5e3:3e4:5e3,[t,r])());return(0,s.jsxs)("div",{className:"w-screen h-screen overflow-hidden relative",children:[(0,s.jsxs)(n.P.div,{className:"flex w-[200vw] h-full",animate:{x:0===t?0:"-50%"},transition:{type:"spring",damping:30,stiffness:300},drag:"x",dragConstraints:{left:-1e3,right:0},dragElastic:.1,onDragStart:()=>{l(!0)},onDragEnd:(a,s)=>{l(!1),(Math.abs(s.offset.x)>100||Math.abs(s.velocity.x)>500)&&(s.offset.x>0&&1===t?e(0):s.offset.x<0&&0===t&&e(1))},style:{cursor:a?"grabbing":"grab"},children:[(0,s.jsx)("div",{className:"w-screen h-screen flex-shrink-0",children:(0,s.jsx)(u,{sharedFlightData:c,isAlertActive:r,setIsAlertActive:o})}),(0,s.jsx)("div",{className:"w-screen h-screen flex-shrink-0",children:(0,s.jsx)(f,{flightData:c})})]}),(0,s.jsxs)("div",{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 flex gap-2 z-50",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full transition-colors duration-300 ".concat(0===t?"bg-white":"bg-white/30")}),(0,s.jsx)("div",{className:"w-2 h-2 rounded-full transition-colors duration-300 ".concat(1===t?"bg-white":"bg-white/30")})]})]})}},5264:(t,e,a)=>{Promise.resolve().then(a.bind(a,4212))}},t=>{t.O(0,[100,441,964,358],()=>t(t.s=5264)),_N_E=t.O()}]);